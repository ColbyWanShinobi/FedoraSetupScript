# Automatically mount all mmcblk* (SD cards) devices with filesystems
# Originally from https://serverfault.com/a/767079

KERNEL!="mmcblk*",              GOTO="automount_end"
ENV{ID_FS_USAGE}!="filesystem", GOTO="automount_end"

# The service expects to be asynchronous and shouldn't block udev rules
ACTION=="add",    RUN+="/usr/bin/systemd-run --no-block --collect /usr/local/libexec/automount/block-device-event.sh add %k"
ACTION=="remove", RUN+="/usr/bin/systemd-run --no-block --collect /usr/local/libexec/automount/block-device-event.sh remove %k"

LABEL="automount_end"
